---
- name: Install sddm themes and dependencies
  shell: "{{ install_command }} {{ sddm_package }}"
  loop:
    - sddm-theme-sugar-candy-git
  loop_control:
    loop_var: sddm_package
  become_user: "{{ username }}"

- name: Update theme of sddm
  replace:
    path: /etc/sddm.conf
    regexp: '^Current=$'
    replace: 'Current=Sugar-Candy'

- name: Copy background pictures
  copy:
    src: Pictures/wallpaper.png
    dest: "/usr/share/sddm/themes/Sugar-Candy/Backgrounds/wallpaper.png"
    owner: "{{ username }}"
    group: "{{ group | default(username) }}"
    directory_mode: yes
    mode: '0777'
    remote_src: yes

- name: Update sddm sugar-candy theme
  copy:
    remote_src: yes
    src: sddm/theme.conf
    dest: "/usr/share/sddm/themes/Sugar-Candy/theme.conf"
    owner: "{{ username }}"
    group: "{{ group | default(username) }}"
    mode: '0755'

